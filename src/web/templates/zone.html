{{#*inline "title"}}Zone: {{zone}}{{/inline}}
{{#*inline "header"}}
<style type="text/css">
table.record_table {
    width: 100%;
    border-spacing: 0;
}
table.record_table th {
    text-align: left;
}
table.record_table th,
table.record_table td {
    padding: 10px;
}
fieldset {
    margin-bottom: 20px;
}
</style>
{{/inline}}
{{#*inline "content"}}

<div class="card shadow mb-4">
    <div class="card-header py-3">
        <h6 class="m-0 font-weight-bold text-primary">Records for {{zone}}

            <button type="button" class="float-right btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#newZone">
                New Record <i class="fa fa-plus"></i>
            </button>
              
        </h6>
    </div>
    <div class="card-body" style="height:100%;">

        <fieldset>
            <table class="record_table table table-striped table-bordered">
                <tr>
                    <th>#</th>
                    <th>Hostname</th>
                    <th>Record Type</th>
                    <th>TTL (seconds)</th>
                    <th>Target/Value</th>
                    <th>Actions</th>
                </tr>
                {{#each records}}
                <tr>
                    <td>{{id}}</td>
                    <td>{{record.domain}}</td>
                    <td>{{record.type}}</td>
                    <td>{{record.ttl}}</td>
                    {{#if record.host}}
                    <td>{{record.host}}</td>
                    {{/if}}
                    {{#if record.addr}}
                    <td>{{record.addr}}</td>
                    {{/if}}
                    <td>
                        <form method="POST" action="/authority/{{../zone}}/delete_record">
                            <input type="hidden" name="domain" value="{{record.domain}}" />
                            <input type="hidden" name="recordtype" value="{{record.type}}" />
                            <input type="hidden" name="ttl" value="{{record.ttl}}" />
                            {{#if record.host}}
                            <input type="hidden" name="host" value="{{record.host}}" />
                            {{/if}}
                            {{#if record.addr}}
                            <input type="hidden" name="host" value="{{record.addr}}" />
                            {{/if}}

                            <button type="submit" class="btn btn-sm btn-danger">Delete <i class="fa fa-trash"></i></button>
                        </form>
                    </td>
                </tr>
                {{/each}}
            </table>
        </fieldset>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="newZone" tabindex="-1" role="dialog" aria-labelledby="newRecordLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="newRecordLabel">New DNS Record</h5>
          <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <form method="POST" action="/authority/{{zone}}">
            <div class="modal-body">
                <div class="form-group">
                    <label for="recordtype">Record Type</label>
                    <small class="form-text text-muted">Select the type of DNS record to create</small>
                    <select class="form-control" name="recordtype" id="recordtype">
                        <option value="A">A - IPv4 Address</option>
                        <option value="AAAA">AAAA - IPv6 Address</option>
                        <option value="CNAME">CNAME - Alias/Canonical Name</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="domain">Hostname/Subdomain</label>
                    <small class="form-text text-muted">The hostname or subdomain for this record (e.g., www, mail, or @ for root)</small>
                    <input class="form-control" type="text" name="domain" id="domain" placeholder="www.{{zone}} or @" />
                </div>

                <div class="form-group">
                    <label for="host">Target/Value</label>
                    <small class="form-text text-muted" id="host-help">For A records: IPv4 address (e.g., 192.168.1.1)<br>For AAAA: IPv6 address<br>For CNAME: Target domain (e.g., example.com)</small>
                    <input class="form-control" type="text" name="host" id="host" placeholder="Enter IP address or domain" />
                </div>

                <div class="form-group">
                    <label for="ttl">TTL (Time To Live)</label>
                    <small class="form-text text-muted">How long DNS resolvers should cache this record (in seconds, default: 3600 = 1 hour)</small>
                    <input class="form-control" type="number" name="ttl" id="ttl" value="3600" />
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel <i class="fa fa-times"></i></button>
                <button type="submit" class="btn btn-primary">Create Record <i class="fa fa-check"></i></button>
            </div>
        </form>
      </div>
    </div>
</div>

<script>
// Update help text based on record type selection
document.getElementById('recordtype').addEventListener('change', function() {
    const helpText = document.getElementById('host-help');
    const hostInput = document.getElementById('host');
    
    switch(this.value) {
        case 'A':
            helpText.innerHTML = 'Enter an IPv4 address (e.g., 192.168.1.1 or 10.0.0.1)';
            hostInput.placeholder = '192.168.1.1';
            break;
        case 'AAAA':
            helpText.innerHTML = 'Enter an IPv6 address (e.g., 2001:db8::1)';
            hostInput.placeholder = '2001:db8::1';
            break;
        case 'CNAME':
            helpText.innerHTML = 'Enter the target domain name (e.g., example.com or cdn.example.com)';
            hostInput.placeholder = 'target.example.com';
            break;
    }
});
</script>
{{/inline}}
{{~> layout~}}
